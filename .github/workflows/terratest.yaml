name: Terratest

on: push

jobs:
  cce-test:
    uses: ./.github/workflows/workflow-terratest.yaml
    name: cce on eu-de and eu-nl
    with:
      context: cce
      region_eu-de: true
      region_eu-nl: true
    secrets: inherit

  vpn-test:
    uses: ./.github/workflows/workflow-terratest.yaml
    name: vpn between eu-de and eu-nl
    with:
      context: vpn
    secrets: inherit

  network-test:
    uses: ./.github/workflows/workflow-terratest.yaml
    name: network on eu-de and eu-nl
    with:
      context: network
      region_eu-de: true
      region_eu-nl: true
    secrets: inherit

  public_dns-test:
    uses: ./.github/workflows/workflow-terratest.yaml
    name: public_dns on eu-de
    with:
      context: public_dns
    secrets: inherit

#FIXME currently not working:
  # rds-test:
  #   uses: ./.github/workflows/workflow-terratest.yaml
  #   name: Run Terratest for public_dns on eu-de
  #   with:
  #     context: rds
  #     region_eu-de: true
  #     region_eu-nl: true
  #   secrets: inherit

  # waf-test:
  #   uses: ./.github/workflows/workflow-terratest.yaml
  #   name: Run Terratest for waf on eu-de
  #   with:
  #     context: waf
  #     region_eu-de: true
  #     region_eu-nl: true
  #   secrets: inherit
